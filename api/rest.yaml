---
swagger: '2.0'
info:
  version: 0.2.0
  title: VMX v0.2 REST API for Object Detection and Recognition
  description: |
    The VMX v0.2 REST API drives vision.ai's suite of object recognition software products.
    
      The VMX REST API lets you create, delete, and edit multiple VMX object detection models and manage a large collection of running object detectors. VMX lets you create multiple sessions, where a session will have its own endpoint URL like `/sessions/mysession1`. A VMX session can hold either one fully editable object detection model or a bundle of compiled models, and with the API you can create a large number of such worker sessions. A single VMX server is engineered to handle a large number of incoming image requests, and different collections of models can be served as different endpoints. See <a href="https://github.com/VISIONAI/vmx-docker-manager#extra-v2-accessing-the-ports-of-the-underlying-vmxworkers">Getting VMXworker ports</a>.
      
      **NOTE:** v1 of the VMX API had a separate VMXserver API which is now **deprected**.  The two APIs used to be very similar but were a little bit different, which was a source of confusion. The new VMXserver API is the **same** API as the main REST API, you just access the VMX endpoint over a port like `http://localhost:9003` instead of the session `http://localhost:3000/session/f034s/`.
      
      ### Related VMX Documentation
      
      It is possible to build full computer vision applications on top of the VMX API, and you are highly encouraged to do so! The VMX GUI uses the VMX API from Javascript, and a lot of training utilities can be written as shell scripts that operate on directories of images.  For documentation on how to use the GUI to create and modify detection models inside the browser, take a look at the 
      
      <a href="../VMXAppBuilder/index.html">VMX GUI Docs</a>
      
      <a href="../VMXinstall/index.html">VMX Installation</a>
      
      ### HTTP-based API
      The VMX API is HTTP-based, so you can use the command line utility `curl`, `request` libraries in Node.js or python, jquery inside the browser, or just about another language which supports GET and POST requests.
      
      ### JSON Input and Output
      All inputs to VMX endpoints are JSON objects specified in the body of the request, and outputs are JSON objects with the information contained inside the `.data` field. If an error occurs, the API will return a non-200 error code and the returned JSON object will contain a `.error` field containing a human-readable error message.
      
      ### DataURL-encoded Images
      VMX consumes images as base64 encoded dataURLs. You can convert an image into an base64 string on the command line, or convert an HTML5 canvas into a dataURL directly in javascript. The VMX model editor returns dataURLS so the API output can be directly inside HTML <**img**> tags.
      
    Let's start VMX and check the version.

    **On a Mac**
    ```
    cd /Applications/VMX.app/Contents/MacOS/
    ./run.sh
    curl localhost:3000/check
    ```

    **On Linux**
    ```
    cd ~/vmx-docker-manager
    ./vmx start 3000
    curl localhost:3000/check
    ```
    
    **If you are accessing a vision.ai hosted VMX node, check either port 80(http) or 443(https)**
    ```
    curl https://vmx.mycompany.com/check
    ```
    
    For a valid and licensed VMX node you should get something like:
    ```
    {
      "uuid": "935169C6-C4E8-4393-875B-D80B5A998615",
      "licensed": true,
      "version": [
        "VMXserver_Linux_v0.2.1",
        "VMXmiddle_Linux_v0.4.1",
        "vmxAppBuilder_v0.2.1"
      ]
    }
    ```
    
    If you're connecting to a VMX node with VMXserver v0.1, you'll need to update VMX. **These docs are for version v0.2.**
      
  contact:
    name: vision.ai API team
    url: https://vision.ai    

host: localhost:3000
schemes:
  - http
paths:
  /sessions:
    get:
      tags: 
        - session management
      summary: List sessions 
      description: "Lists the active VMXworker sessions. Returns the session ids and summaries of the models loaded in each session.
      
        
        GUI: <a href=\"/#/sessions\">/#/sessions</a> 
        "
    
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              type: array
              items:
                $ref: '#/definitions/SessionSummary'
    post:
      tags: 
        - session management
      summary: Create a New Session
      description: "Create a new VMXworker session.  Each worker has its own unique id and is accessible at `/sessions/{sessionId}`. After session creation, you'll be able to load a collection of object detection models into the session (`/sessions/{sessionId}/load` route). You can get a randomly generated session id in the form of a uuid (**default behavior**), or you can provide the session id you want via the `id` field of the input json. *The user-specified `id` must contain only lowercase alphanumeric characters and a combination of hyphens and underscores.*
      
        #### Session Id Examples
        
        `b93f0157-a3ca-488b-99f5-2afd400f6c8b` is an example of a typical id autogenerated by VMX.
        
        `large-cat-faces`, `a`, and `body_parts-nov12` are valid session ids (as long as they aren't already used).
        
        
        `myDog`, `df!`, `car orientations`. and `Stop-sign` are all invalid session ids.
      
      
        ##### Note on broken sessions
      
         If your `/sessions/` listing doesn't show the taken SessionId, but you're getting a 409, then perhaps one of the VMXworkers was taken down abruptuly (this happens in development). Consider manually removing the contents of the `${VMX_DIR}/sessions/SessionId` folder.
      
      
        "
      
      parameters:
        - in: body
          name: body
          description: The new id
          schema:
            $ref: "#/definitions/CreateSessionInput"
      responses:
        200:
          description: OK
          schema:
            properties:
              data:
                $ref: '#/definitions/SessionSummary'
                  
        400:
          description: "`id` contains illegal characters"
          schema:
            properties:
              error:
                type: string
                description: "A description of the error"
        409:
          description: "`id` already taken" 
          schema:
            properties:
              error:
                type: string
                description: "A description of the error"

   
       
  /sessions/{sessionId}:
    get:
      tags: 
        - session management
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
      summary: "Get session info"
      responses:
        200:
          description: OK
          schema:
            properties:
              data:
                $ref: '#/definitions/SessionSummary'
        404:
          description: "Not Found"
    post:
      tags: 
        - detection
      summary: Process Image by applying current model. 
      description: "Process Image by applying current model. Even though the input must be an array of images, for detection and learning is only performed on the first image. Allows the model to grow in size by enabling `learning_mode`. Will not allow `learning_mode` when `config.read_only` is set to `true`."
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: Process Image Payload
          required: true
          schema:
            $ref: "#/definitions/ProcessImageInput"
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              properties:
                model:
                  $ref: "#/definitions/ModelSummary"
                objects:
                  type: array
                  items:
                    $ref: "#/definitions/Object"
        400:
          description: Cannot process image
    delete:
      tags:
        - session management
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
      summary: "Delete current session from VMX"
      responses:
        200:
          description: "OK"  
        404:
          description: Session id not found

  /sessions/{sessionId}/save:
    post:
      tags: 
        - model_loading
      summary: Save currently loaded model
      description: "Save the currently loaded model into the `${VMX_DIR}` directory. Allows for renaming the model as well as generating a new UUID for the saved model. If the currently loaded model is a bundle, then a new UUID cannot be generated since bundle UUIDs are determined from the component UUIDs. Will not allow save operation when `config.read_only` is set to `true`."
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: Information about the saved model
          required: true
          schema:
            $ref: "#/definitions/SaveModelInput"
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              properties:
                model:
                  $ref: "#/definitions/ModelSummary"
                full_MB:
                  type: number
                  description: "The size of the full model in Megabytes"
                compiled_MB:
                  type: number
                  description: "The size of the compiled model in Megabytes"
        400:
          description: Problem saving model

  /sessions/{sessionId}/load:
    post:
      tags: 
        - model_loading
      summary: Load models
      description: "Load one or moremodels from `${VMX_DIR}` into the worker. If a group of models is loaded, a bundle is created (a new model which contains the submodels) and saved. Loading will not work if `config.read_only` is `true`."
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: List of UUIDs and whether they should be compiled
          required: true
          schema:
            $ref: "#/definitions/LoadModelInput"
    
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              properties:
                model:
                  $ref: "#/definitions/ModelSummary"
                  
        400:
          description: Problem Loading Model(s)

  /sessions/{sessionId}/process:
    post:
      tags: 
        - detection
      summary: Process Image by applying current model. 
      description: "Process Image by applying current model. Even though the input must be an array of images, for detection and learning is only performed on the first image. Allows the model to grow in size by enabling `learning_mode`. Will not allow `learning_mode` when `config.read_only` is set to `true`."
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: Process Image Payload
          required: true
          schema:
            $ref: "#/definitions/ProcessImageInput"
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              properties:
                model:
                  $ref: "#/definitions/ModelSummary"
                objects:
                  type: array
                  items:
                    $ref: "#/definitions/Object"
        400:
          description: Cannot process image

  /sessions/{sessionId}/create:
    post:
      tags: 
        - detection
      summary: Create a new model
      description: "Create a new model given a dataset, a model name, a pretrained file, and detection/creation parameters. 
  
      
        1.) Will look for the pretrained file inside the `data` directory specified in `config.json`, 
  
        
        2.) If not present, will look for the pretrained file in the `/VMXdata/` directory (and copy it over to your `data` directory) 
  
        
        3.) Will download the file from `https://files.vision.ai/vmx/pretrained/` (as long as `config.allow_urls` is set to true) into your `data` directory.
      
        VMXserver comes with two pretrained files. To get a listing of available pretrained files, run:
        
        `curl https://files.vision.ai/vmx/pretrained/MD5SUMS.json`
          
        "
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: Model Creation payload
          required: true
          schema:
            $ref: "#/definitions/CreateModelInput"
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              properties:
                model:
                  $ref: "#/definitions/ModelSummary"
                objectives:
                  $ref: "#/definitions/Objectives"
        400:
          description: Unable to create model. Either `config.read_only` is set to `false` (see set_config) or there was a problem with your payload. 

  /sessions/{sessionId}/edit:
    post:
      tags: 
        - detection
      summary: Edit model
      description: "Edit/show the positive examples inside the model. Can be used to show image crops of the positives/negatives, swap examples, or remove examples.
      
      
        
        GUI: <a href=\"/#/sessions/sessionId/edit\">/#/sessions/sessionId/edit</a> 
        
        "
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: Edit Model Payload
          required: true
          schema:
            $ref: "#/definitions/EditModelInput"
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              properties:
                images:
                  type: array
                  items:
                    $ref: "#/definitions/Image"
                objectives:
                  $ref: "#/definitions/Objectives"
        400:
          description: Cannot edit model

  

  /sessions/{sessionId}/params:
    get:
      tags: 
        - settings
      summary: Get the detection params
      description: "Get the detection params"
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
      responses:
        200:
          description: OK
          schema:
            properties:
              data:
                $ref: "#/definitions/Params"
  /sessions/{sessionId}/config:
    get:
      tags: 
        - settings
      summary: Get the configuration object
      description: "Get the configuration object"
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
      responses:
        200:
          description: OK
          schema:
            properties:
              data:
                $ref: "#/definitions/Config"
    post:
      tags: 
        - settings
      summary: Set the configuration object
      description: "Set the configuration object. Allows for only a subset of the available config fields to be present in the input payload.  In other words, you can set one config param at a time."
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
        - in: body
          name: body
          description: Input Configuration Fields
          schema:
            $ref: "#/definitions/ConfigInput"
      responses:
        200:
          description: OK
          schema:
            properties:
              data:
                $ref: "#/definitions/Config"
                
  /sessions/{sessionId}/log.txt:
    get:
      tags: 
        - settings
      summary: Get the last line of the log
      description: "Get the last line of the log
      
      
        
        GUI: <a href=\"/#/sessions/sessionId/log.txt\">/#/sessions/sessionId/log.txt</a> 
        
        "
      parameters:
        - name: sessionId
          in: path
          type: string
          description: ID of the session
          required: true
      responses:
        200:
          description: OK
             

  /models:
     get:
      tags: 
        - model_library
      summary: List models
      description: "List the models inside `${VMX_DIR}` by returning a summary representation of each model
      
      
        
        GUI: <a href=\"/#/models\">/#/models</a> 
        "
      
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              type: array
              items:
                $ref: '#/definitions/ModelSummary'
        400:
          description: Model Library Broken

  /models/{modelUUID}:
     get:
      tags: 
        - model_library
      summary: Show model summary
      description: "Show the model summary"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              $ref: '#/definitions/ModelSummary'
        404:
          description: Model Not Found
          
  /models/{modelUUID}/model.json:
     get:
      tags: 
        - model_library
      summary: Show model summary
      description: "Show the model summary. Same as `/models/{modelUUID}` "
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              $ref: '#/definitions/ModelSummary'
        404:
          description: Model Not Found
          
  /models/{modelUUID}/model.data:
     get:
      tags: 
        - model_library
      summary: Get full model (binary format)
      description: "Get the full uncompiled model in binary form"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              $ref: '#/definitions/ModelSummary'
        404:
          description: Model Not Found
          
  /models/{modelUUID}/compiled.data:
     get:
      tags: 
        - model_library
      summary: Get compiled model (binary format)
      description: "Get the compiled model in binary form"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              $ref: '#/definitions/ModelSummary'
        404:
          description: Model Not Found
          
  /models/{modelUUID}/image.jpg:
     get:
      tags: 
        - model_library
      summary: Get model summary icon
      description: "Get the model summary icon"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              $ref: '#/definitions/ModelSummary'
        404:
          description: Model Not Found
          
  /models/{modelUUID}/data_set.json:
    get:
      tags: 
        - model_library
      summary: Get model's dataset as json
      description: "Get the model's dataset as json"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
          schema:
           properties:
            data:
              type: array 
              items:
                $ref: '#/definitions/Image'
            
        404:
          description: Model Not Found
          
  /models/{modelUUID}/data_set/first.jpg:
    get:
      tags: 
        - model_library
      summary: Get model's dataset's first image
      description: "Get the model's dataset as json"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
        404:
          description: Model Not Found
          
  /models/{modelUUID}/data_set/image.jpg:
    get:
      tags: 
        - model_library
      summary: Get model's dataset's next image
      description: "Get the model's dataset as json"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
        404:
          description: Model Not Found
          
  /models/{modelUUID}/data_set/random.jpg:
    get:
      tags: 
        - model_library
      summary: Get model's dataset's random image
      description: "Get the model's dataset as json"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
        404:
          description: Model Not Found
  /models/{modelUUID}/reset_cache:
    post:
      tags: 
        - model_library
      summary: Reset model cache
      description: "Reset model cache"
      parameters:
        - name: modelUUID
          in: path
          type: string
          description: UUID of the model
          required: true
      responses:
        200:
          description: OK
        404:
          description: Model Not Found
          
          
          
  /check:
    get:
      tags: 
        - activation
      summary: Check VMX version and whether it is activated
      description: "Check VMX version"
      responses:
        200:
          description: OK
          schema:
           properties:
            uuid:
              type: string
              description: "The identifier for this VMX install"
            licensed:
              type: boolean
              description: "Whether this copy is licensed or not"
            version:
              type: array
              items:
                type: string
              description: "The three versions of the VMX components used in this install"
              
  /activate/{LicenseKey}:
    post:
      tags: 
        - activation
      summary: Activate this copy of VMX
      description: "Activate this copy of VMX. A request is made to https://beta.vision.ai/ to obtain a valid license file for this machine. Requires an unused License Key."
      parameters:
        - name: LicenseKey
          in: path
          type: string
          description: An unused VMX License Key
          required: true
        - in: body
          name: body
          description: Licensing Payload
          required: true
          schema:
            $ref: "#/definitions/ActivateInput"
      responses:
        200:
          description: OK
          
          
  /random:
    get:
      tags:
        - utility
      summary: Get a random image from the model library
      responses:
        200:
          description: OK
          
  /forward:
    get:
      tags:
        - utility
      summary: Forward from a remote IP camera to local
      description: "Forward from a remote IP camera by using the ?q URL parameter"
      responses:
        200:
          description: OK
          
    
definitions:
  LoadModelInput:
    required:
      - uuids
    properties:
      compiled:
        type: boolean
        example: false
        description: "If enabled, will load the model in compiled mode. Compiled models are not editable, but they use less memory and are a bit faster for detection. When loading a collection of models, they will be in compiled mode. There is no way to load a collection of uncompiled models. Only one model can be uncompiled at a time."
      uuids:
        type: array
        description: "A collection of UUIDs to load"
        items:
          type: string

  SaveModelInput:
    properties:
      name:
        type: string
        example: left_hand_up
        default: ""
        description: "If present and non-empty, will assign the new name to the model.  This will not change the UUID, just the `name` field that show up in listing models and assigning tags to detection boxes"
      new_uuid:
        type: boolean
        example: false
        default: false
        description: "If true, will assign a new UUID, effectively copying the model."
        
  ModelSummary:
    properties:
      name:
        type: string
        example: "tom's hand"
        description: "A human readable model name"
      uuid:
        type: string
        example: "17b86476-d430-4ecb-8185-aff17c18321c"
        description: "The unique identifier for the model. Model bundles (collections of models) do not have hyphens in the UUID, and individual models have UUIDs in standard 36 character format"
      meta:
        type: string
        description: "Extra meta information about the model. Bundles will use comma separated names of individual models for the meta tag."
      history:
        description: "The name of the pretrained file used to generate the model. Will be an array of the individual models if model is a bundle."
        type: array
        items:
          type: string
      compiled:
        type: boolean
        description: "Whether the model is compiled or not"
      version:
        type: string
        description: "The version of VMX which generated this model"
      image:
        type: string
        description: "image description (dataurl or image relative to vmx_dir)"
        example: "models/53255aee-f032-4df1-a61e-1502f1df33d4/image.jpg"
      size:
        type: array
        items:
          type: integer
        description: "The size of the model"
      num_pos:
        type: integer
        description: "The number of positive examples in the model"
      num_neg:
        type: integer
        description: "The number of negative examples in the model"
      start_time:
        type: string
        description: "Model creation time"
      end_time:
        type: string
        description: "Last image/datapoint time"  
  CreateModelInput:
    required:
      - name
      - pretrained
      - images
      - params
    properties:
      name:
        type: string
      pretrained:
        type: string
        description: "The pretrained file to use for model creation. Will default to the `pretrained` filed inside the `config.json` file next to the binary."
        
      images:
        type: array 
        items:
          $ref: '#/definitions/Image'
      params:
        $ref: '#/definitions/Params'

  
  Image:
    required:
      - image
    properties:
      image:
        type: string
        example: "http://people.csail.mit.edu/tomasz/img/tomasz_blue_crop.jpg"
        description: "The base64 encoded image or URL pointing to image, works with base64 type prefix or not"
      objects:
        type: array
        items:
          $ref: '#/definitions/Object'
  
  Object:
    required:
     - name
     - bb
    properties:
      name:
        type: string
        example: "left_hand"
        description: "The object's human readable name"
      bb:
        type: array
        minLength: 4
        maxLength: 4
        items:
          type: number
        description: "The object's bounding box (4 numbers)"
      score:
        type: number
        description: "optional score associated with example"
      data:
        description: "Extra data stored with the example"
        type: array
        minLength: 4
        maxLength: 4
        items:
          type: number
      id:
        type: integer
        description: "optional id used to index examples when using edit_model"
      class_label:
        type: integer
        description: "optional class_label used to denote positives (+1), negatives (-1), or remove example (0)"
        
        
  Params:
    properties:
      detect_max_overlap:
        type: number
        default: 0.3
        description: "The non-maximum suppression threshold which will remove redundant (highly-overlapping windows).  This number ranges from [0,1] and 0 will not allow any returned detectections to overlap, while a 1.0 will keep all detection windows."
        minimum: 0.0
        maximum: 1.0
      detect_add_flip:
        type: boolean
        default: false
        description: "If enabled, will perform detection on left-right flip of input image. Detection then takes twice as long, but only one image needs to be sent to the server."
      levels_per_octave:
        type: integer
        default: 10
        minimum: 1
        maximum: 20
        description: "The levels per octave parameters describes how many different levels we use for object detection.  An octave is a halving of the original image, so 10 levels per octave means we will be looking at 10 different images sizes betwen the original and the halved image. Must be between 1 and 20. Lower will make detection faster, but be careful for scale-dependent blind spots."
      max_windows:
        type: integer
        default: 100
        minimum: 0
        description: "The maximum number of raw detection windows to consider before applying non-maximum suppression.  The final number of detections will always be smaller than max_windows as non-maximum suppression will likely remove some.  The detector becomes really fast for max_windows=0, but it has better performance for large
          max_windows values."
      max_image_size:
        type: integer
        default: 320
        minimum: 0
        description: "The maximum input image size (in number of pixels for either width or height).  You are free to send a larger image, but it will be resized to this size if the input is larger. Resizing maintains the aspect ratio, and makes sure that the maximum dimension is within this limit."
        
      learn_mode:
        type: boolean
        default: false
        description: "If enabled, go into learn mode."
        
      learn_iterations:
        type: integer
        default: 10
        minimum: 0
        description: "The number of learning iterations after each successful update while processing images in \"learn mode\"."
        
      learn_max_positives:
        type: integer
        default: 1
        minimum: 0
        description: "The maximum number of positives which can be extracted from a single image during one step of `learn_mode`.  NOTE that to be considered a positive, then score must be above learn_threshold. You can make the detector treat everything as negatives by setting learn_max_positives to 0, and the learn_threshold to a really low value like -1.  You can make the detector treat all detections above 0 as positives by setting learn_max_positives to something large like 100 and the learn_threshold to 0.  NOTE: If you feed VMX an image with many true positives but learn_max_positives is set to 1, then only the highest scoring detection will be treated as a positive and the remaining detections as negatives."
        
      learn_threshold:
        type: number
        default: 0
        description: "Object detections scoring above this threshold will be considered as positives while in `learn mode`. At most `learn_max_positives` will be treated as positives."
        
      cell_size:
        type: integer
        default: 4
        minimum: 2
        description: "The spatial cell size (in pixels) used to analyze the input image.  This is the size of the regions for which statistical computations are performed."
      
      initialize_max_cells: 
        type: integer
        default: 10
        minimum: 1
        description: "The maximum template dimension (measured in cells) used during initialization. Model sizes are reported as #cells x #cells. This parameter makes sure that you don't get very large cell sizes for model creation. If you decide to create a model with initialize_max_cells set to a small value like 4, you might get models that are 2x4, 4x1, etc.  They will be really fast, but much coarser than your typical 8x10 models."
        
      initialize_add_flip:
        type: boolean
        default: false
        description: "If enabled, model creation will add left-right flips of positives to generate 2X training data, then select the best of each flip."
        
      train_max_positives:
        type: integer
        default: 1000
        minimum: 1
        description: "The maximum number of positives inside the learned model.  VMX automatically adjust the number of positives (by dropping the least useful examples) when a larger number is reached when using learning mode."
        
      train_max_negatives:
        type: integer
        default: 2000
        minimum: 1
        description: "The maximum number of positives inside the learned model.  VMX automatically adjust the number of positives (by dropping the least useful examples) when a larger number is reached when using learning mode."
        
      crop_radius:
        type: integer
        default: 80
        description: "The number of pixels around the object of interest to be used in crop mode.  This greatly improves the speed of the detector as fewer regions need to be analyzed. NOTE: this is only used inside the VMX GUI (aka vmxAppBuilder) but stored inside VMX as a convenience."
        
      display_threshold:
        type: number
        default: 0
        description: "When using process_image, drop all detections below this threshold. Mac Only: Objects scoring above this threshold will be rendered on the screen when config.display_images is enabled."
        
      jpeg_quality:
        type: number
        default: 1
        description: "The JPEG Quality factor controls the size (in MB) of the image but creates compression artifacts. Note: this is only used inside the VMX GUI (aka vmxAppBuilder) but stored inside the model as a convenience."

  Settings:
    required:
      - max_positives
      - max_negatives
    properties:
      learn_iterations:
        type: integer
        description: "The number of learning updates"
        minimum: 0
        maximum: 1000
        default: 0
      max_positives:
        type: integer
        description: "The maximum number of positives to show"
        minimum: 0
        default: 20
      max_negatives:
        type: integer
        description: "The maximum number of negatives to show"
        minimum: 0
        default: 20
      positives_order:
        type: integer
        description: "The ordering on the positives. 1 is ascending order, -1 is descending order."
        default: 1
      negatives_order:
        type: integer
        description: "The ordering on the negatives. 1 is ascending order, -1 is descending order."
        default: -1
      image_size:
        type: integer
        description: "The size of the resulting image crops (expressed as size of maximum dimension). A value of 0 will not even generate resulting images"
        default: 100
        minimum: 0
        maximum: 1000
      pad_scale:
        type: number
        minimum: 0
        maximum: 2
        default: 1
        description: "How much to pad around each exemplar, useful for showing extra context around an object. 1 is the defalut which shows a tight image crop around the exemplar. 0 will not even show images, and 2 will show 200% of the original exemplar."

  Change:
    required:
      - id
      - class_label
    properties:
      image:
        type: string  
      score:
        type: number
      class_label:
        type: integer
        description: "Should be -1 for negative, +1 for postive, and 0 for remove_me"
      id:
        type: integer
        description: "The unique identifier for the exemplar"
      time:
        type: string
        description: "Time associated with datapoint"
      data:
        type: array
        items: 
          type: number
          
  SessionSummary:
    properties:
      model:
        description: "The model summary"
        $ref: '#/definitions/ModelSummary'
      id:
        type: string
        description: "The session id"
  
  EditModelInput:
    required:
      - changes
      - settings
    properties:
      changes:
        type: array
        items:
          $ref: '#/definitions/Change'
      settings:
        $ref: '#/definitions/Settings'
        
  ProcessImageInput:
    required:
      - images
    properties:
      images:
        type: array 
        items:
          $ref: '#/definitions/Image'
      params:
        $ref: '#/definitions/Params'
      name:
        type: string
        default: ""
        description: "The name of the detections we want. Useful if you have a session loaded with 100s of models, but you just want detections of a certain category. NOTE: currently not implemented"
        
  Config:
    properties:
      pretrained:
        type: string
        description: "The default pretrained file used for model creation when the `pretrained` field is empty inside `create_model`."
      log_images:
        type: boolean
        description: "Whether to log full images or grep them out in the JSON-based session log. Both `create_model` and `process_image` operations contain dataURLs in the payload, so if you are going to be sharing logs, it is best practice to remove these dataURLs. The `edit_model` operation will contain dataURLs in the output.  If `log_images` is enabled, the dataURLs are replaced with the string \"IMAGE\""
        default: false
      log_memory:
        type: boolean
        default: false
        description: "If enabled, will add `memory` field to each line of the JSON log. This is useful for debugging, but should not be used in production."  
      display_images:
        type: boolean
        default: false
        description: "If enabled, will render images and bounding boxes on your Desktop.  Only works on `Mac OS X`."
      allow_urls:
        type: boolean
        default: true
        description: "If enabled, will allow input images (for both `create_model` and `process_image` requests) to be URLs.  This is a very handy feature, but it is advised to turn this feature off for production."
      read_only:
        type: boolean
        default: false
        description: "If enabled, will only allow read-only operations. This means `create_model`, `edit_model`, and `exit` won't work."
  
  ConfigInput:
    properties:
      config:
        $ref: '#/definitions/Config'
        
  Objectives:
    properties:
      obj:
        type: number
        description: "The objective function value (with regularization terms added). The lower the better."
      obj_raw:
        type: number
        description: "The objective function value (without regularization terms added). The lower the better."
        
  ActivateInput:
    properties:
      email:
        type: string
        description: "your email address"
        
  CreateSessionInput:
    properties:
      id:
        type: string
        default: ""
        description: "The desired session id, if not specified, will autogenerate one for you. The string must be alphanumeric, at least length 1, and the only valid non-alphanumeric character is the dash"
      